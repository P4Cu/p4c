# This file have to use only features common to BASH/ZSH

# export TERM=screen-256color # no <S-Fx> keys
# export TERM=xterm-256color
export EDITOR='nvim'
export DEFAULT_USER='p4c'
export GOPATH=$HOME/apps/go

## ----------------------------------------------------------------------------
## ALIASES
## ----------------------------------------------------------------------------
alias nvimo='nvim +OpenSession'
alias gnp='git --no-pager'
alias cdg='cd-gitroot'
alias cdr='cd-reporoot'
alias o='xdg-open'
# alias rm='/bin/safe-rm'
lt='ls -laht'

# --------------------------------------------------------------------------------------------------
# PATHS
[[ $PATH != *"${P4C}/bin"* ]] && export PATH="${PATH}:${P4C}/bin"
[[ $PATH != *"${HOME}/bin"* ]] && export PATH="${PATH}:${HOME}/bin"
[[ $PATH != *"/opt/go/bin:${HOME}/apps/go/bin"* ]] && export PATH="${PATH}:/opt/go/bin:${HOME}/apps/go/bin"
# --------------------------------------------------------------------------------------------------

## ----------------------------------------------------------------------------
## completition
## ----------------------------------------------------------------------------
## custom commands
complete -c command type which-edit

## requires source-higlight
export LESSOPEN="| /usr/share/source-highlight/src-hilite-lesspipe.sh %s" ; export LESS=' -R '

patchset() { (
        set -e
        if [[ -z $1 ]]; then echo "gerrit id needed" ; exit 0 ; fi
        remotes=$(git ls-remote origin "refs/changes/*/$1/*")
        latest_patchset=$(echo $remotes | cut -f2 | rev | cut -d'/' -f1 | rev | sort -n | tail -1)
        as_ref=$(echo $remotes | grep -e "/$latest_patchset$" | cut -f2)
        echo "$as_ref" | xsel -bi || true
        echo $as_ref
) }
